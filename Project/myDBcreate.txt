-- 1. STATION 

CREATE TABLE S20_1_STATION 
   (	STATION_CODE VARCHAR2(4) NOT NULL, 
	STATION_NAME VARCHAR2(20) NOT NULL, 
	NO_OF_PLATFORMS NUMBER(2,0) NOT NULL, 
	PHONE_NO NUMBER(10,0),
	primary key(STATION_CODE)
   ) ;




-- 2. Bogie

  CREATE TABLE S20_1_BOGIE
   (	BOGIE_NO NUMBER(5,0) NOT NULL, 
	CLASS VARCHAR2(3) NOT NULL, 
	MANUFACTURED_YEAR NUMBER(4,0) NOT NULL, 
	STATION_CODE VARCHAR2(3) NOT NULL,
	primary key(BOGIE_NO),
	FOREIGN KEY (STATION_CODE)
	  REFERENCES S20_1_STATION (STATION_CODE) ON DELETE CASCADE
   ) ;




-- 3. Route

  CREATE TABLE S20_1_ROUTE
   (	ROUTE_NO NUMBER(3,0) NOT NULL, 
	SOURCE_STATION_CODE VARCHAR2(4) NOT NULL, 
	DEST_STATION_CODE VARCHAR2(4) NOT NULL, 
	DISTANCE VARCHAR2(4) NOT NULL,
	primary key(ROUTE_NO),
	FOREIGN KEY (SOURCE_STATION_CODE)
	  REFERENCES S20_1_STATION (STATION_CODE) ON DELETE CASCADE,
	FOREIGN KEY (DEST_STATION_CODE)
	  REFERENCES S20_1_STATION (STATION_CODE) ON DELETE CASCADE
   ) ;





-- 4. Train

CREATE TABLE S20_1_TRAIN
   (	TRAIN_NO NUMBER(*,0) NOT NULL, 
	TRAIN_NAME VARCHAR2(40) NOT NULL, 
	START_DATE DATE DEFAULT NULL, 
	END_DATE DATE DEFAULT NULL, 
	TYPE VARCHAR2(20), 
	RUNTIME NUMBER(*,0), 
	NO_OF_SL_SEATS NUMBER(*,0), 
	NO_OF_3AC_SEATS NUMBER(*,0), 
	NO_OF_2AC_SEATS NUMBER(*,0), 
	NO_OF_1AC_SEATS NUMBER(*,0), 
	ROUTE_NO NUMBER(*,0) NOT NULL, 
	SCHEDULED_ARR_TIME VARCHAR2(20), 
	SCHEDULED_DEPT_TIME VARCHAR2(20),
	primary key(TRAIN_NO),
	FOREIGN KEY(ROUTE_NO)
	  REFERENCES S20_1_ROUTE(ROUTE_NO) ON DELETE CASCADE
   ) ;




-- 5. Train_Operational_Days

  CREATE TABLE S20_1_TRAIN_OPERATIONAL_DAYS
   (	TRAIN_NO NUMBER NOT NULL, 
	ROUTE_NUMBER NUMBER NOT NULL, 
	DAYS_OF_OPERATION VARCHAR2(10) NOT NULL,
	UNIQUE (TRAIN_NO, DAYS_OF_OPERATION),
	FOREIGN KEY (TRAIN_NO)
	  REFERENCES S20_1_TRAIN (TRAIN_NO) ON DELETE CASCADE,
	FOREIGN KEY (ROUTE_NUMBER)
	  REFERENCES S20_1_ROUTE (ROUTE_NO) ON DELETE CASCADE	
   ) ;




-- 6. Train_Arrival

  CREATE TABLE S20_1_TRAIN_ARRIVAL
   (	TRAIN_NO NUMBER(5,0) NOT NULL, 
	STATION_CODE VARCHAR2(3) NOT NULL, 
	ARRIVAL_DATE DATE, 
	ARRIVAL_TIME VARCHAR2(20),
	UNIQUE (TRAIN_NO,ARRIVAL_DATE, ARRIVAL_TIME),
	FOREIGN KEY ("TRAIN_NO")
	  REFERENCES "SXS1987"."S20_1_TRAIN" ("TRAIN_NO") ON DELETE CASCADE,
	FOREIGN KEY ("STATION_CODE")
	  REFERENCES "SXS1987"."S20_1_STATION" ("STATION_CODE") ON DELETE CASCADE
   ) ;








--7. Train_Departure

  CREATE TABLE S20_1_TRAIN_DEPARTURE
   (	TRAIN_NO NUMBER(5,0) NOT NULL, 
	STATION_CODE VARCHAR2(3) NOT NULL, 
	DEPARTURE_DATE DATE, 
	DEPARTURE_TIME VARCHAR2(20),
	UNIQUE (TRAIN_NO, DEPARTURE_DATE, DEPARTURE_TIME)
   ) ;









CREATE TABLE PRINCIPAL(
	P_ID	 char(9) 	not null,
	fName	 varchar(25) 	not null,
	lName	 varchar(25) 	not null,
	DOB	 date,
	SSN	 char(9)	not null,
	EPhone	 varchar(20),
	Password varchar(30),
	primary key(P_ID),
	unique(SSN)
);

CREATE TABLE TEACHER(
	T_ID	 char(9) 	not null,
	fName	 varchar(25) 	not null,
	lName	 varchar(25) 	not null,
	DOB	 date,
	SSN	 char(9)	not null,
	EPhone	 varchar(20),
	Password varchar(30),
	P_ID	 char(9),
	EDate	 date,
	primary key(T_ID),
	foreign key(P_ID) references PRINCIPAL(P_ID)
		on delete cascade,
	unique(SSN)
);

CREATE TABLE COUNSELOR(
	c_ID	 char(9) 	not null,
	fName	 varchar(25) 	not null,
	lName	 varchar(25) 	not null,
	DOB	 date,
	SSN	 char(9)	not null,
	EPhone	 varchar(20),
	Password varchar(30),
	primary key(C_ID),
	unique(SSN)
);

CREATE TABLE ATTENDANCE_CLERK(
	A_ID	 char(9) 	not null,
	fName	 varchar(25) 	not null,
	lName	 varchar(25) 	not null,
	DOB	 date,
	SSN	 char(9)	not null,
	EPhone	 varchar(20),
	Password varchar(30),
	primary key(A_ID),
	unique(SSN)
);

CREATE TABLE STUDENT(
	fName		varchar(25)	not null,
	lName		varchar(25)	not null,
	S_ID		char(9)		not null,
	Classification	char(3) 	not null
		check (Classification = 'REG' or Classification = 'SIP'),
	Address		char(75),
	Phone		varchar(20),
	primary key(S_ID)
);

-- This table was not populated for phase 3 of the project.  It is here 
-- just for the purpose of completeness.
--
CREATE TABLE ABSENCE_REC(
	S_ID	char(9)		not null,
	ADate	date		not null,
	Type	char(3)		not null
		check(Type = 'EXC' or Type = 'UNX' or Type = 'EVT'),
	A_ID	char(9) 	not null,
	primary key(ADate),
	unique(S_ID, ADate),
	foreign key(S_ID) references STUDENT(S_ID)
		on delete cascade,
	foreign key(A_ID) references ATTENDANCE_CLERK(A_ID)
		on delete cascade
);

CREATE TABLE COURSE(
	CNumber		varchar(8)		not null,
	Sess		varchar(6)		not null,
	Year		int			not null
			check(Year > 1600 and Year < 2400),
	Type		varchar(7)		not null
			check(Type = 'AP' or Type = 'Regular' or Type = 'Honors'),
	CName		varchar(25),
	T_ID		char(9) 		not null,
	RmNum		char(5)			not null,
	R_Type		varchar(15)		not null,
	Capacity	int,
	Period		int			not null
			check(Period between 0 and 9),
	primary key(CNumber, Sess, Year),
	foreign key(T_ID) references TEACHER(T_ID) 
		on delete cascade
);

CREATE TABLE TAKES(
	S_ID		char(9)			not null,
	CNumber		varchar(8)		not null,
	Sess		varchar(6)		not null,
	Year		int			not null,
	Grade		int
		check(Grade = null or (Grade between 0 and 100)),
	primary key(S_ID, CNumber, Sess, Year),
	foreign key(S_ID) references STUDENT(S_ID)
		on delete cascade,
	foreign key(CNumber, Sess, Year) references COURSE(CNumber, Sess, Year)
		on delete cascade
);

CREATE TABLE CONSULTS_DATE(
	S_ID	char(9)		not null,
	C_ID	char(9) 	not null,	
	cDate	date		not null,
	primary key(CDate),
	unique(S_ID, C_ID, CDate),
	foreign key(S_ID) references STUDENT(S_ID)
		on delete cascade,
	foreign key(C_ID) references COUNSELOR(C_ID)
		on delete cascade
);

-- This table was not populated for phase 3 of the project.  It is here 
-- just for the purpose of completeness.
--
CREATE TABLE MISBEHAVIOR_ACTION( 
	S_ID	char(9)		not null,
	P_ID	char(9) 	not null,
	T_ID	char(9) 	not null,
	begDate	date		not null,	
	endDate	date		not null,	
	Type	char(3)		not null
		check(Type = 'SUS' OR Type = 'IHS' OR Type = 'THD'),
	primary key(begDate, endDate, Type),
	foreign key(S_ID) references STUDENT(S_ID)
		on delete cascade,
	foreign key(P_ID) references PRINCIPAL(P_ID)
		on delete cascade,
	foreign key(T_ID) references TEACHER(T_ID) 
		on delete cascade
);	

